<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>gdt_x64 Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">gdt_x64 Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:aa453d76a5baf65dbebd8b2980f1f3ed1"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgdt__x64.html#aa453d76a5baf65dbebd8b2980f1f3ed1">size_type</a> = uint16_t</td></tr>
<tr class="separator:aa453d76a5baf65dbebd8b2980f1f3ed1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7b85ab7ebafbecf64fa858c481830d5"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgdt__x64.html#ad7b85ab7ebafbecf64fa858c481830d5">index_type</a> = uint16_t</td></tr>
<tr class="separator:ad7b85ab7ebafbecf64fa858c481830d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad026d6bc69461c84861a2d6892af22a0"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgdt__x64.html#ad026d6bc69461c84861a2d6892af22a0">integer_pointer</a> = uintptr_t</td></tr>
<tr class="separator:ad026d6bc69461c84861a2d6892af22a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0803fa6df7ad4789d70521f6da7c6252"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgdt__x64.html#a0803fa6df7ad4789d70521f6da7c6252">base_type</a> = uint64_t</td></tr>
<tr class="separator:a0803fa6df7ad4789d70521f6da7c6252"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73fa92c5703241e9b7b4c93d8c754571"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgdt__x64.html#a73fa92c5703241e9b7b4c93d8c754571">limit_type</a> = uint32_t</td></tr>
<tr class="separator:a73fa92c5703241e9b7b4c93d8c754571"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92063b9dcdc52fcf524233425c5b6d65"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgdt__x64.html#a92063b9dcdc52fcf524233425c5b6d65">access_rights_type</a> = uint32_t</td></tr>
<tr class="separator:a92063b9dcdc52fcf524233425c5b6d65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46d758258312e703b165254573eed729"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgdt__x64.html#a46d758258312e703b165254573eed729">segment_descriptor_type</a> = uint64_t</td></tr>
<tr class="separator:a46d758258312e703b165254573eed729"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a79ec3671b6c812ffb6c767893fa5e388"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgdt__x64.html#a79ec3671b6c812ffb6c767893fa5e388">gdt_x64</a> () <a class="el" href="vmx__intel__x64__mock_8cpp.html#a77ef1e3cf14f172741bc80b259147038">noexcept</a></td></tr>
<tr class="separator:a79ec3671b6c812ffb6c767893fa5e388"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eb09161c4e0202bd58847017632d33f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgdt__x64.html#a2eb09161c4e0202bd58847017632d33f">gdt_x64</a> (<a class="el" href="classgdt__x64.html#aa453d76a5baf65dbebd8b2980f1f3ed1">size_type</a> size) <a class="el" href="vmx__intel__x64__mock_8cpp.html#a77ef1e3cf14f172741bc80b259147038">noexcept</a></td></tr>
<tr class="separator:a2eb09161c4e0202bd58847017632d33f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad733181e184c63770ee76a009a308995"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgdt__x64.html#ad733181e184c63770ee76a009a308995">~gdt_x64</a> () <a class="el" href="vmx__intel__x64__mock_8cpp.html#a77ef1e3cf14f172741bc80b259147038">noexcept</a>=default</td></tr>
<tr class="separator:ad733181e184c63770ee76a009a308995"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac525dedb989e69c85a14f3453768d293"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classgdt__x64.html#ad026d6bc69461c84861a2d6892af22a0">integer_pointer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgdt__x64.html#ac525dedb989e69c85a14f3453768d293">base</a> () const</td></tr>
<tr class="separator:ac525dedb989e69c85a14f3453768d293"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae34af6a090d8c3cc6e391f423a93406d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classgdt__x64.html#aa453d76a5baf65dbebd8b2980f1f3ed1">size_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgdt__x64.html#ae34af6a090d8c3cc6e391f423a93406d">limit</a> () const</td></tr>
<tr class="separator:ae34af6a090d8c3cc6e391f423a93406d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1c1b70c59f2c5a2400b4dd819160de2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgdt__x64.html#ad1c1b70c59f2c5a2400b4dd819160de2">set_base</a> (<a class="el" href="classgdt__x64.html#ad7b85ab7ebafbecf64fa858c481830d5">index_type</a> index, <a class="el" href="classgdt__x64.html#a0803fa6df7ad4789d70521f6da7c6252">base_type</a> <a class="el" href="classbase.html">base</a>)</td></tr>
<tr class="separator:ad1c1b70c59f2c5a2400b4dd819160de2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb45322912b23268d60c8eeaa1d085cc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classgdt__x64.html#a0803fa6df7ad4789d70521f6da7c6252">base_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgdt__x64.html#adb45322912b23268d60c8eeaa1d085cc">base</a> (<a class="el" href="classgdt__x64.html#ad7b85ab7ebafbecf64fa858c481830d5">index_type</a> index) const</td></tr>
<tr class="separator:adb45322912b23268d60c8eeaa1d085cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35b070e9ce3e69e8ca242cb5ed32bfd6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgdt__x64.html#a35b070e9ce3e69e8ca242cb5ed32bfd6">set_limit</a> (<a class="el" href="classgdt__x64.html#ad7b85ab7ebafbecf64fa858c481830d5">index_type</a> index, <a class="el" href="classgdt__x64.html#a73fa92c5703241e9b7b4c93d8c754571">limit_type</a> <a class="el" href="classgdt__x64.html#ae34af6a090d8c3cc6e391f423a93406d">limit</a>)</td></tr>
<tr class="separator:a35b070e9ce3e69e8ca242cb5ed32bfd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d609d19a2d7b5ac366bcb784916719a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classgdt__x64.html#a73fa92c5703241e9b7b4c93d8c754571">limit_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgdt__x64.html#a9d609d19a2d7b5ac366bcb784916719a">limit</a> (<a class="el" href="classgdt__x64.html#ad7b85ab7ebafbecf64fa858c481830d5">index_type</a> index) const</td></tr>
<tr class="separator:a9d609d19a2d7b5ac366bcb784916719a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad709d08d841d6c12c36e6b4df42f330b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgdt__x64.html#ad709d08d841d6c12c36e6b4df42f330b">set_access_rights</a> (<a class="el" href="classgdt__x64.html#ad7b85ab7ebafbecf64fa858c481830d5">index_type</a> index, <a class="el" href="classgdt__x64.html#a92063b9dcdc52fcf524233425c5b6d65">access_rights_type</a> <a class="el" href="classgdt__x64.html#a6b035571aac3a02142a9d9cf5cfd8f40">access_rights</a>)</td></tr>
<tr class="separator:ad709d08d841d6c12c36e6b4df42f330b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b035571aac3a02142a9d9cf5cfd8f40"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classgdt__x64.html#a92063b9dcdc52fcf524233425c5b6d65">access_rights_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgdt__x64.html#a6b035571aac3a02142a9d9cf5cfd8f40">access_rights</a> (<a class="el" href="classgdt__x64.html#ad7b85ab7ebafbecf64fa858c481830d5">index_type</a> index) const</td></tr>
<tr class="separator:a6b035571aac3a02142a9d9cf5cfd8f40"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Global Descriptor Table</p>
<p>This class provides an abstraction around the global descriptor table for 64bit.</p>
<p>This class does not provide a "descriptor" class as the amount of code needed to completely abstract each descriptor type would be enormous for something that is setup once, and never touched again. So it is left to the user to understand how to set the access rights for each descriptor manually, as this is the part that is descriptor specific. In general, all of the information about each descriptor can be found in the Intel Manual in Volume 3.</p>
<p>Generally speaking, there are 2 different types of descriptors, a code/data segment descriptor, and a TSS descriptor.</p>
<p>A code/data segment descriptor is a descriptor that is loaded into es, cs, ss, ds, fs or gs. Information about these types of descriptors can be found in Volume 3, section 3.4.5. A code segment is any segment that is loaded into CS. Although not called out in all of the documentation, Intel does have a stack segment which is any descriptor loaded into SS, and the access rights are different for a stack segment. Finally there are data segments which are any descriptor loaded into es, ds, fs and gs. On 64bit, es and ds are not available, so they should always point to the NULL descriptor, which is the first descriptor in the table, which has to be set to all 0s (per the spec). The only parts of cs, ss, fs, and gs that are used are the access rights. The CPU in 64bit mode assumes that the base is set to 0, and the limit is 0xFFFFF. Although the limit is only 4G (because it's only 20 bits), the CPU internally sets the limit to 2^64 for you. fs and gs are the only segments that can have a base address not set to 0, but they cannot be set using the GDT, and instead have to be set using the MSRs. Bareflank uses gs to store the offset into the state save area for the exit handler.</p>
<p>A TSS descriptor defines the task state segment. This is a structure that is defined 7.2 (for 32bit), and 7.7 (for 64bit). The OS might fill in this structure for syscalls, but in general, this structure is not used in 64bit, but still needs to be defined. For a hypervisor, this structure can be left blank. The base address of the TSS descriptor needs to be the address of the TSS, the limit should be sizeof(TSS), which for a hypervisor that doesn't use the IO bitmap, or any custom data is 104 bytes, and the access rights are set to a present 64bit TSS. There is one complication with the TSS descriptor which is that you cannot simply call ltr (load task register) with any TSS. The TSS cannot have the busy flags set. Since there is a TSS that the host OS has, and a TSS for the VMM, this tends to be fine, up to the point where the VMM attempts to promote the guest. When this happens, there are actually two TSS descriptors marked as busy, which should never happen, but does. The solution is to mark the host OS's TSS descriptor as not busy manually before loading it. </p>

<p class="definition">Definition at line <a class="el" href="gdt__x64_8h_source.html#l00190">190</a> of file <a class="el" href="gdt__x64_8h_source.html">gdt_x64.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="aa453d76a5baf65dbebd8b2980f1f3ed1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa453d76a5baf65dbebd8b2980f1f3ed1">&#9670;&nbsp;</a></span>size_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classgdt__x64.html#aa453d76a5baf65dbebd8b2980f1f3ed1">gdt_x64::size_type</a> =  uint16_t</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gdt__x64_8h_source.html#l00194">194</a> of file <a class="el" href="gdt__x64_8h_source.html">gdt_x64.h</a>.</p>

</div>
</div>
<a id="ad7b85ab7ebafbecf64fa858c481830d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7b85ab7ebafbecf64fa858c481830d5">&#9670;&nbsp;</a></span>index_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classgdt__x64.html#ad7b85ab7ebafbecf64fa858c481830d5">gdt_x64::index_type</a> =  uint16_t</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gdt__x64_8h_source.html#l00195">195</a> of file <a class="el" href="gdt__x64_8h_source.html">gdt_x64.h</a>.</p>

</div>
</div>
<a id="ad026d6bc69461c84861a2d6892af22a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad026d6bc69461c84861a2d6892af22a0">&#9670;&nbsp;</a></span>integer_pointer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classgdt__x64.html#ad026d6bc69461c84861a2d6892af22a0">gdt_x64::integer_pointer</a> =  uintptr_t</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gdt__x64_8h_source.html#l00196">196</a> of file <a class="el" href="gdt__x64_8h_source.html">gdt_x64.h</a>.</p>

</div>
</div>
<a id="a0803fa6df7ad4789d70521f6da7c6252"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0803fa6df7ad4789d70521f6da7c6252">&#9670;&nbsp;</a></span>base_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classgdt__x64.html#a0803fa6df7ad4789d70521f6da7c6252">gdt_x64::base_type</a> =  uint64_t</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gdt__x64_8h_source.html#l00197">197</a> of file <a class="el" href="gdt__x64_8h_source.html">gdt_x64.h</a>.</p>

</div>
</div>
<a id="a73fa92c5703241e9b7b4c93d8c754571"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73fa92c5703241e9b7b4c93d8c754571">&#9670;&nbsp;</a></span>limit_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classgdt__x64.html#a73fa92c5703241e9b7b4c93d8c754571">gdt_x64::limit_type</a> =  uint32_t</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gdt__x64_8h_source.html#l00198">198</a> of file <a class="el" href="gdt__x64_8h_source.html">gdt_x64.h</a>.</p>

</div>
</div>
<a id="a92063b9dcdc52fcf524233425c5b6d65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92063b9dcdc52fcf524233425c5b6d65">&#9670;&nbsp;</a></span>access_rights_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classgdt__x64.html#a92063b9dcdc52fcf524233425c5b6d65">gdt_x64::access_rights_type</a> =  uint32_t</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gdt__x64_8h_source.html#l00199">199</a> of file <a class="el" href="gdt__x64_8h_source.html">gdt_x64.h</a>.</p>

</div>
</div>
<a id="a46d758258312e703b165254573eed729"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46d758258312e703b165254573eed729">&#9670;&nbsp;</a></span>segment_descriptor_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classgdt__x64.html#a46d758258312e703b165254573eed729">gdt_x64::segment_descriptor_type</a> =  uint64_t</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gdt__x64_8h_source.html#l00200">200</a> of file <a class="el" href="gdt__x64_8h_source.html">gdt_x64.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a79ec3671b6c812ffb6c767893fa5e388"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79ec3671b6c812ffb6c767893fa5e388">&#9670;&nbsp;</a></span>gdt_x64() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gdt_x64::gdt_x64 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructor</p>
<p>Creates a GDT based on the GDT currently in hardware.</p>
<dl class="section pre"><dt>Precondition</dt><dd>expects: none </dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>ensures: none</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This copies the current GDT. Therefore, the set functions do not modify the GDT that is in hardware, but instead modify the copy. If you want to modify the GDT that is in hardware, create a new GDT using an alternate constructor, and set the hardware to use that GDT instead. </dd></dl>

<p class="definition">Definition at line <a class="el" href="gdt__x64_8h_source.html#l00215">215</a> of file <a class="el" href="gdt__x64_8h_source.html">gdt_x64.h</a>.</p>

</div>
</div>
<a id="a2eb09161c4e0202bd58847017632d33f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2eb09161c4e0202bd58847017632d33f">&#9670;&nbsp;</a></span>gdt_x64() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gdt_x64::gdt_x64 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgdt__x64.html#aa453d76a5baf65dbebd8b2980f1f3ed1">size_type</a>&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructor</p>
<p>Creates a new GDT, with size defining the number of descriptors in the GDT.</p>
<dl class="section post"><dt>Postcondition</dt><dd>ensures: none </dd>
<dd>
ensures: none</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>number of entries in the GDT </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gdt__x64_8h_source.html#l00236">236</a> of file <a class="el" href="gdt__x64_8h_source.html">gdt_x64.h</a>.</p>

</div>
</div>
<a id="ad733181e184c63770ee76a009a308995"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad733181e184c63770ee76a009a308995">&#9670;&nbsp;</a></span>~gdt_x64()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gdt_x64::~gdt_x64 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Destructor</p>
<dl class="section pre"><dt>Precondition</dt><dd>expects: none </dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>ensures: none </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ac525dedb989e69c85a14f3453768d293"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac525dedb989e69c85a14f3453768d293">&#9670;&nbsp;</a></span>base() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classgdt__x64.html#ad026d6bc69461c84861a2d6892af22a0">integer_pointer</a> gdt_x64::base </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>GDT Base Address</p>
<dl class="section pre"><dt>Precondition</dt><dd>expects: none </dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>ensures: none</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>returns the base address of the GDT itself. </dd></dl>

<p class="definition">Definition at line <a class="el" href="gdt__x64_8h_source.html#l00260">260</a> of file <a class="el" href="gdt__x64_8h_source.html">gdt_x64.h</a>.</p>

</div>
</div>
<a id="ae34af6a090d8c3cc6e391f423a93406d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae34af6a090d8c3cc6e391f423a93406d">&#9670;&nbsp;</a></span>limit() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classgdt__x64.html#aa453d76a5baf65dbebd8b2980f1f3ed1">size_type</a> gdt_x64::limit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>GDT Limit</p>
<dl class="section pre"><dt>Precondition</dt><dd>expects: none </dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>ensures: none</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>returns the size of the GDT itself in bytes </dd></dl>

<p class="definition">Definition at line <a class="el" href="gdt__x64_8h_source.html#l00270">270</a> of file <a class="el" href="gdt__x64_8h_source.html">gdt_x64.h</a>.</p>

</div>
</div>
<a id="ad1c1b70c59f2c5a2400b4dd819160de2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1c1b70c59f2c5a2400b4dd819160de2">&#9670;&nbsp;</a></span>set_base()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void gdt_x64::set_base </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgdt__x64.html#ad7b85ab7ebafbecf64fa858c481830d5">index_type</a>&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgdt__x64.html#a0803fa6df7ad4789d70521f6da7c6252">base_type</a>&#160;</td>
          <td class="paramname"><em>base</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set Descriptor Base Address</p>
<p>Sets the base address of a descriptor. If the descriptor is a TSS (determined using the system descriptor flag), the base address is a 64bit address, and this operation will attempt to touch 2 64bit descriptor fields. So, if the TSS is at the end of the GDT (like they usually are) make sure you give yourself space for 2 entries for the TSS, otherwise this code will throw an invalid_argument exception. Also, since the access rights determine the descriptor type, make sure you set them first.</p>
<dl class="section pre"><dt>Precondition</dt><dd>expects: index != 0 </dd>
<dd>
expects: index &lt; <a class="el" href="namespacex64_1_1page__table_1_1pml4.html#a967ca7babc7b0f44bc486cddaecb2a35">m_gdt.size()</a> </dd>
<dd>
expects: index &lt; <a class="el" href="namespacex64_1_1page__table_1_1pml4.html#a967ca7babc7b0f44bc486cddaecb2a35">m_gdt.size()</a> + 1 (if system descriptor) </dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>ensures: none</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>the index of the GDT descriptor </td></tr>
    <tr><td class="paramname">base</td><td>the base address. For code/data descriptor this needs to be 0, and for a TSS this is a 64bit virtual address. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gdt__x64_8h_source.html#l00293">293</a> of file <a class="el" href="gdt__x64_8h_source.html">gdt_x64.h</a>.</p>

</div>
</div>
<a id="adb45322912b23268d60c8eeaa1d085cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb45322912b23268d60c8eeaa1d085cc">&#9670;&nbsp;</a></span>base() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classgdt__x64.html#a0803fa6df7ad4789d70521f6da7c6252">base_type</a> gdt_x64::base </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgdt__x64.html#ad7b85ab7ebafbecf64fa858c481830d5">index_type</a>&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get Descriptor Base Address</p>
<p>Gets the base address of a descriptor. If the descriptor is a TSS (determined using the system descriptor flag), the base address is a 64bit address, and this operation will attempt to touch 2 64bit descriptor fields. So, if the TSS is at the end of the GDT (like they usually are) make sure you give yourself space for 2 entries for the TSS, otherwise this code will throw an invalid_argument exception. Also, since the access rights determine the descriptor type, make sure you set them first.</p>
<dl class="section pre"><dt>Precondition</dt><dd>expects: index != 0 </dd>
<dd>
expects: index &lt; <a class="el" href="namespacex64_1_1page__table_1_1pml4.html#a967ca7babc7b0f44bc486cddaecb2a35">m_gdt.size()</a> </dd>
<dd>
expects: index &lt; <a class="el" href="namespacex64_1_1page__table_1_1pml4.html#a967ca7babc7b0f44bc486cddaecb2a35">m_gdt.size()</a> + 1 (if system descriptor) </dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>ensures: none</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>the index of the GDT descriptor </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the base address </dd></dl>

<p class="definition">Definition at line <a class="el" href="gdt__x64_8h_source.html#l00360">360</a> of file <a class="el" href="gdt__x64_8h_source.html">gdt_x64.h</a>.</p>

</div>
</div>
<a id="a35b070e9ce3e69e8ca242cb5ed32bfd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35b070e9ce3e69e8ca242cb5ed32bfd6">&#9670;&nbsp;</a></span>set_limit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void gdt_x64::set_limit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgdt__x64.html#ad7b85ab7ebafbecf64fa858c481830d5">index_type</a>&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgdt__x64.html#a73fa92c5703241e9b7b4c93d8c754571">limit_type</a>&#160;</td>
          <td class="paramname"><em>limit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set Descriptor Limit</p>
<p>Sets the descriptors limit. Note that for code/data descriptors, this needs to be 0xFFFFF as segmentation is not used in 64bit. For the TSS, the limit should be the size in bytes of the TSS, and any other data you wish to store.</p>
<dl class="section pre"><dt>Precondition</dt><dd>expects: index != 0 </dd>
<dd>
expects: index &lt; <a class="el" href="namespacex64_1_1page__table_1_1pml4.html#a967ca7babc7b0f44bc486cddaecb2a35">m_gdt.size()</a> </dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>ensures: none</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>the index of the GDT descriptor </td></tr>
    <tr><td class="paramname">limit</td><td>the descriptors limit </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gdt__x64_8h_source.html#l00416">416</a> of file <a class="el" href="gdt__x64_8h_source.html">gdt_x64.h</a>.</p>

</div>
</div>
<a id="a9d609d19a2d7b5ac366bcb784916719a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d609d19a2d7b5ac366bcb784916719a">&#9670;&nbsp;</a></span>limit() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classgdt__x64.html#a73fa92c5703241e9b7b4c93d8c754571">limit_type</a> gdt_x64::limit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgdt__x64.html#ad7b85ab7ebafbecf64fa858c481830d5">index_type</a>&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get Descriptor Limit</p>
<p>Gets the descriptors limit.</p>
<dl class="section pre"><dt>Precondition</dt><dd>expects: index != 0 </dd>
<dd>
expects: index &lt; <a class="el" href="namespacex64_1_1page__table_1_1pml4.html#a967ca7babc7b0f44bc486cddaecb2a35">m_gdt.size()</a> </dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>ensures: none</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>the index of the GDT descriptor </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the descriptors limit </dd></dl>

<p class="definition">Definition at line <a class="el" href="gdt__x64_8h_source.html#l00451">451</a> of file <a class="el" href="gdt__x64_8h_source.html">gdt_x64.h</a>.</p>

</div>
</div>
<a id="ad709d08d841d6c12c36e6b4df42f330b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad709d08d841d6c12c36e6b4df42f330b">&#9670;&nbsp;</a></span>set_access_rights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void gdt_x64::set_access_rights </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgdt__x64.html#ad7b85ab7ebafbecf64fa858c481830d5">index_type</a>&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgdt__x64.html#a92063b9dcdc52fcf524233425c5b6d65">access_rights_type</a>&#160;</td>
          <td class="paramname"><em>access_rights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set Descriptor Access Rights</p>
<p>Sets the descriptors access rights. Note that Intel defines this field a little strange. Unlike the base and limit, where the fields and merged, the access rights leaves the upper "limit" bits in the access rights, so you have to leave bits 8-11 as 0 as these are bits 16-19 of the limit field. Also, each bit in the access rights field has a different meaning based on which segment register is used. If CS is used, the descriptor is a code segment, if TR is used the descriptor is a TSS descriptor, if SS is used the segment is a stack segment, and all others are data segments. For a complete list of what each bit does (based on what segment register is loading this descriptor), please see the Intel manual.</p>
<dl class="section pre"><dt>Precondition</dt><dd>expects: index != 0 </dd>
<dd>
expects: index &lt; <a class="el" href="namespacex64_1_1page__table_1_1pml4.html#a967ca7babc7b0f44bc486cddaecb2a35">m_gdt.size()</a> </dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>ensures: none</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>the index of the GDT descriptor </td></tr>
    <tr><td class="paramname">access_rights</td><td>the access rights for this descriptor </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gdt__x64_8h_source.html#l00501">501</a> of file <a class="el" href="gdt__x64_8h_source.html">gdt_x64.h</a>.</p>

</div>
</div>
<a id="a6b035571aac3a02142a9d9cf5cfd8f40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b035571aac3a02142a9d9cf5cfd8f40">&#9670;&nbsp;</a></span>access_rights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classgdt__x64.html#a92063b9dcdc52fcf524233425c5b6d65">access_rights_type</a> gdt_x64::access_rights </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgdt__x64.html#ad7b85ab7ebafbecf64fa858c481830d5">index_type</a>&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get Descriptor Access Rights</p>
<p>Gets the access rights for the descriptor</p>
<dl class="section pre"><dt>Precondition</dt><dd>expects: index != 0 </dd>
<dd>
expects: index &lt; <a class="el" href="namespacex64_1_1page__table_1_1pml4.html#a967ca7babc7b0f44bc486cddaecb2a35">m_gdt.size()</a> </dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>ensures: none</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>the index of the GDT descriptor </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the descriptors access rights </dd></dl>

<p class="definition">Definition at line <a class="el" href="gdt__x64_8h_source.html#l00534">534</a> of file <a class="el" href="gdt__x64_8h_source.html">gdt_x64.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/user/hypervisor/bfvmm/include/intrinsics/<a class="el" href="gdt__x64_8h_source.html">gdt_x64.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Apr 28 2017 21:30:48 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
