<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>/home/user/hypervisor/common/README.md Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">/home/user/hypervisor/common/README.md</div>  </div>
</div><!--header-->
<div class="contents">
<a href="common_2_r_e_a_d_m_e_8md.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;# Build System</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;## Description</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Currently, Bareflank uses a custom build system that depends on GNU make. Someday we might attempt to use cmake, but at the moment we are using our own custom build system. The purpose of this build system is to compile:</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;- All cross compiled source (including dummy modules)</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;- All native source</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;- All unit tests</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;- Driver entries</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;## How It is Used</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;To make this work, the build system is broken up into three main files:</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;- common_subdir.mk</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;- common_target.mk</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;- common_test.mk</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;The subdir makefile moves make recursively into the different subdirectories. Generally there are two different types of subdir makefiles: parent subdirs, and target subdirs. The parent subdir makefiles link to other subdir makefiles, while the target subdir makefiles link to folders that have target makefiles (they actually compile something). A parent subdir makefile can have pretty much any folder name while the target subdir makefiles can have any folder name except bin and test. Any folder named bin should be used to contain compiled results and additional makefiles for testing. Any folder named test will get compiled after all other folders, ensuring that all of the libraries are compiled and available for testing (to resolve cyclic dependencies). </div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;The target makefile is capable of compiling both cross compiled sources and target sources (and in a lot of cases both, which is how most of the VMM source files are compiled). For example, the vCPU module for the VMM needs to be compiled using the cross compiler so that the library can be loaded and used by the driver entries, but also needs to be compiled natively so that it can be used in a unit test. The Bareflank Manager (BFM) only needs to be compiled natively since it is always used on the native system (it is not loaded by the driver entry), while the dummy modules only need to be compiled using the cross compiler as they are only used to test the ELF loader and driver entry code. The target makefile tries to contain all of the business logic in itself, while exposing a set of variables each target can set in it&#39;s own makefile, providing a simple way to create makefiles for each target. </div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;Finally the test makefile is used by &quot;make run_tests&quot;. This makefile executes a test, and simplifies the output to prevent confusion when running the tests (as these tests can spit out a lot of garbage as error conditions are being tested). </div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;## Notes</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;Running &quot;make&quot; will compile everything no matter what folder you are in. You can however run &quot;make build_src&quot; or &quot;make build_tests&quot; if you are only interested in a specific portion of the code. The same applies to &quot;make clean&quot; vs &quot;make clean_src&quot; and &quot;make clean_tests&quot;. </div></div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Apr 20 2016 15:38:37 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
