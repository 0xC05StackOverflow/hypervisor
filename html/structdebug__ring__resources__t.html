<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>debug_ring_resources_t Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="classes.html"><span>Data&#160;Structure&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle">
<div class="title">debug_ring_resources_t Struct Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:adb05adf22a0be0e2df9a0909346c5180"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdebug__ring__resources__t.html#adb05adf22a0be0e2df9a0909346c5180">epos</a></td></tr>
<tr class="separator:adb05adf22a0be0e2df9a0909346c5180"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76d3a9ef0e52996e532376a9f092f4a4"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdebug__ring__resources__t.html#a76d3a9ef0e52996e532376a9f092f4a4">spos</a></td></tr>
<tr class="separator:a76d3a9ef0e52996e532376a9f092f4a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade58c5ddd0da9068a0f8da722e020e97"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdebug__ring__resources__t.html#ade58c5ddd0da9068a0f8da722e020e97">buf</a> [<a class="el" href="constants_8h.html#a75a2c394920980bb722a2b07877e40eb">DEBUG_RING_SIZE</a>]</td></tr>
<tr class="separator:ade58c5ddd0da9068a0f8da722e020e97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Debug Ring Resources</p>
<p>Each driver entry needs to allocate some memory for the debug ring, and then cast this structure over the allocated memory to access the bits used by the ring.</p>
<p>Prior to providing this structure to the debug ring, the memory should be cleared, and the len of the buffer should be set to the total length of memory allocated minus the size of <a class="el" href="structdebug__ring__resources__t.html">debug_ring_resources_t</a>.</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> len = PAGE_SIZE * 100;</div><div class="line"><span class="keyword">struct </span><a class="code" href="structdebug__ring__resources__t.html">debug_ring_resources_t</a> *<a class="code" href="test__debug__ring_8cpp.html#ae26a2456daebadee1c1bde823af67a29">drr</a> = valloc(len);</div><div class="line"></div><div class="line">memset(drr, 0, len);</div><div class="line">drr-&gt;len = len - <span class="keyword">sizeof</span>(<a class="code" href="structdebug__ring__resources__t.html">debug_ring_resources_t</a>);</div><div class="line"></div><div class="line">&lt;give to vmm and <span class="keywordflow">do</span> stuff&gt;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> ret;</div><div class="line"><span class="keywordtype">char</span> read_buf[len]</div><div class="line"></div><div class="line">ret = <a class="code" href="debug__ring__interface_8h.html#a9789e3b8cc928bcf2f8ace91080db8e5">debug_ring_read</a>(drr, read_buf, len);</div><div class="line"><span class="keywordflow">if</span>(ret &lt; 0)</div><div class="line">    &lt;report error&gt;</div></div><!-- fragment --><p>Note there are many different designs for cicular buffers, but all of the designs have to face the same problem. How to detect when the buffer is full vs when it is empty. This design uses two counters the grow forever. The current position in the buffer is then pos % len. If the counters are 64bit, it would take a life time for the counters to overflow. </p>

<p>Definition at line <a class="el" href="debug__ring__interface_8h_source.html#l00094">94</a> of file <a class="el" href="debug__ring__interface_8h_source.html">debug_ring_interface.h</a>.</p>
</div><h2 class="groupheader">Field Documentation</h2>
<a class="anchor" id="adb05adf22a0be0e2df9a0909346c5180"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">debug_ring_resources_t::epos</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>the end position in the circular buffer </p>

<p>Definition at line <a class="el" href="debug__ring__interface_8h_source.html#l00096">96</a> of file <a class="el" href="debug__ring__interface_8h_source.html">debug_ring_interface.h</a>.</p>

</div>
</div>
<a class="anchor" id="a76d3a9ef0e52996e532376a9f092f4a4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">debug_ring_resources_t::spos</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>the start position in the circular buffer </p>

<p>Definition at line <a class="el" href="debug__ring__interface_8h_source.html#l00097">97</a> of file <a class="el" href="debug__ring__interface_8h_source.html">debug_ring_interface.h</a>.</p>

</div>
</div>
<a class="anchor" id="ade58c5ddd0da9068a0f8da722e020e97"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">debug_ring_resources_t::buf</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>the circular buffer that stores the debug strings. </p>

<p>Definition at line <a class="el" href="debug__ring__interface_8h_source.html#l00099">99</a> of file <a class="el" href="debug__ring__interface_8h_source.html">debug_ring_interface.h</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>/home/user/hypervisor/include/<a class="el" href="debug__ring__interface_8h_source.html">debug_ring_interface.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Apr 20 2016 18:22:04 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
